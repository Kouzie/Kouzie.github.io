---
title:  "수학 - 확률분포 개요!"

read_time: false
share: false
author_profile: false
# classes: wide

categories:
  - math

tags:
  - 미적분

toc: true
toc_sticky: true

---

## 개요  

확률분포는 크게 **이산확률분포, 연속확률분포** 2가지로 나뉜다.


> 이산(離散)값, discrete value(흩어져있는 값), 연속성이 전혀 없는 분리된 상태를 뜻한다.  
> 이산확률분포는 확률변수가 셀 수 있는 제한된 개수(자연수)로 구성된다.  

**이산확률분포**에는 아래 종류의 분포가 있다.  

1. **베르누이분포**  
1. **이항분포**  
1. 기하분포  
1. 음이항분포  
1. 포아송분포  
1. 초기하분포  
1. 다항분포  


**연속확률분포**는 아래와 같은 분포가 있다.  

1. **균등분포**
2. **정규분포**
3. **표준정규분포**
4. 가수분포
5. T분포
6. 카이제곱분포
7. F분포
8. 감마분포
9. 웨이블분포
10. 베타분포

### 확률변수  

변수 $w$ 를 입력하면 해당 변수의 확률이 출력되는 함수 $f(w)$ 가 있을때  
변수 $w$ 들의 집합을 확률변수라 한다.    
일반적으로 확률변수는 $X(w)$ 대문자로 표기한다.  

이번엔 **실수의 확률변수**를 알아보자  
확률변수 $X(w)$ 의 각 원소가 $w=(u,v)$ 2개의 실수, 아래 그림의 범위를 가질때(각 최소/최대값 0/1)  
그림과 같이 당첨과 탈락으로 나눈다 가정하자.  

![1](/assets/math/statistics//probability2.png)

$$ X(u,v) = \begin{cases}
    당첨 & (0 \le v \le \frac{1}{4}) \\
    탈락 & (\frac{1}{4} \le v \le 1) 
\end{cases} $$


$$ Y(u,v) = \begin{cases}
    당첨 & (2u + v \le 1) \\
    탈락 & \mathrm{else}
\end{cases} $$

확률변수 $X$ 에서는 $u$ 값과 상관 없이 당첨되며 당첨 면적은 $\frac{1}{4}$
또 다른 경우의 확률변수 $Y$ 애서는 $2u+v$ 를 입력값으로 받으며 당첨면적은 마찬가지로 $\frac{1}{4}$ 이다.  

**두 확률변수의 결과값은 같지만 동일한 확률변수라고 할순 없다.**  

### 확률분포

확률변수가 확률적으로 출력될수 있는 입력값이라면
확률분포는 대략적으로 면적만을 신경 쓰는 개념이다.  

![1](/assets/math/statistics/probability2.png)  

위의 $X, Y$ 에 대한 확률변수의 **확률분포**는 아래와 같다.  

$$ P(X=k) = \begin{cases}
    \frac{1}{4} & k=당첨 \\
    \frac{3}{4} & k=탈락 
\end{cases} $$

$$ P(Y=k) = \begin{cases}
    \frac{1}{4} & k=당첨 \\
    \frac{3}{4} & k=탈락 
\end{cases} $$

**두 확률변수는 다르지만 확률분포는 같다.**  

**즉 확률분포는 $X(w)=k$ 가 될 확률(영역의 면적) 를 정렬한 목록** 을 뜻한다.  

확률분포의 모든 합은 반드시 1이며 [$P(\Omega)=1$]

대부분 확률분포 기호는 $P(X=k)$라 하지 않고 생략해서 $P(k)$로 사용한다.  

> 하지만 $X(w)$가 $k$가 되는 면적임을 항상 잊지 말자   

또 모든 확률은 절대 겹치지 않는다.  

![1](/assets/math/statistics/probability4.png)

동시에 일어난다는 전제라 하더라도 그림처럼 별도의 공간으로 분리하고 아래 식으로 표현한다.  

$P(X=3 \ or \ X=7) = P(X=3) + P(X=7)$ 

### 조건부확률(given), 획일확률(uniform)

![1](/assets/math/statistics/probability5.png)

**조건부확률**의 계산을 위해 간단한 예를 들어보자.  

경계선을 기반으로 A, B, C 구역으로 나누고 각 구역에는 주택, 공장, 논밭이 있다.  

그리고 아래와 같이 총 면적 $\Omega=1$ 을 나누어 계산할 수 있다.  

$$ P(A,주택) + P(A,공장) + P(A,논밭) + \\
   P(B,주택) + P(B,공장) + P(B,논밭) + \\
   P(C,주택) + P(C,공장) + P(C,논밭) =1$$
   
여기서 A구역인 $P(A)$ 만 따로 때어 비중으로 계산할 수 있다.  

$P(주택|A) = \frac{P(A,주택)}{P(A)}$

$|$ 기호는 **조건부확률** 기호이며 주어진 비중이라 할 수 있다.  

A구역내 주택이 차지하는 면적비중을 구하였고  
비중으로 계산했기 때문에 아래 식이 성립한다.  

$P(주택|A) + P(공장|A) + P(논밭|A) = 1$

또 주택이 차지하는 비중과 $P(A)$의 면적을 곱하면 면적이 나온다.  

$P(A,주택) = P(주택|A) P(A)$

이번엔 A,B,C 구역 기준이 아닌 주택, 공장, 논밭 기준으로 면적과 비중을 구해보자.  

$P(A|공장) = \frac{P(A,공장)}{P(공장)}$

전체 공장 면적중 A구역이 차지하는 비중을 알 수 있다.  

이번엔 **획일확률** 에 대해 알아보자.  

![1](/assets/math/statistics/probability6.png)

위 그림처럼 각 도가 **똑같은 비율** 로 주택, 공장, 논밭을 할당했을 때  

각 구역별 시설의 비중은 동일할 것이다.  

$P(주택|A) = P(주택|B) = P(주택|C)$

각 시설별 구역의 비중을 구해도 동일하다  
모든 시설에서 A구역이 할당하는 비중은 10%정도 일 것이다.  

$P(A|주택) = P(A|공장) = P(A|논밭)$


전체 면적 기준으로 시설 비중을 구해도 같을 것이다.  

$$P(주택|A) = P(주택) \\ 
P(A, 주택) = P(A)P(주택)$$

지금까지 이해하기 편하게 하기 위해 시설과 구역으로 나누어 면적을 기준으로 계산했지만  
구역과 시설은 단순 $P$의 확률변수 일 뿐이다.  

### 결합확률, 주변확률

여러 조건을 지정하고 **모든 조건이 동시에 성립하는 확률을 결합확률**이라 하며 동시확률이라 부르기도 한다.  

다시 위의 예제를 이용해 구역을 확률변수 $X$, 시설을 확률변수 $Y$ 로 생각했을 때 
**결합확률**은 $P(X=a, Y=b)$ 혹은 $P_{X,Y}(a,b)$ 로 표기한다.  

**결합확률의 각 조건을 주변확률** 이라 한다.
$P(X=a), P(Y=b)$ 등이 **주변확률**이 된다.  

**결합확률과 주변확률의 관계**는 아래와 같다.  
$P(X=a) = \sum_b P(X=a, Y=b)$
$P(Y=b) = \sum_a P(X=a, Y=b)$

> $\sum_b$ 는 $a$는 고정이고 $b$가 계속 변한다는 뜻

> **결합확률**은 전체구역을 기준으로 잡고 비중을 구하고  
> **조건부확률**을 특정 구역을 기준으로 잡고 비중을 구한다.  
> **조건부확률**은 확률변수옆에 `|` 기호를 사용하고 **결합확률**은 `,` 기호를 사용한다.  

> **결합확률, 조건부확률**의 차이는 **비중을 두는 기준의 차이**이다. 
> 신의 관점으로 면적 1 기준으로는 둘의 차이는 없다.  


**조건부분포를 결합분포로** 표현하면 아래와 같다.  
$P(Y=b | X=a) = \frac{P(Y=b, X=a)}{P(X=a)}$

**결합분포를 조건부분포로** 표현하면 아래와 같다.  
$P(Y=b, X=a) = P(Y=b | X=a)P(X=a)$

조금만 생각해보면 결합분포란 

- 조건 $a$ 가 일어날 상황과   
- $a$ 가 일어난 상황에서 $b$ 가 일어난 상황

두 확률을 곱한것임을 알 수 있다.  

만약 주변확률이 3가지 라면?

$P( X=a,Y=b,Z=c) = P(X=a|Y=b,Z=c)P(Y=b|Z=c)P(Z=c)$

우측 끝부터 해석하면 

- $c$가 일어나고  
- $c$가 일어난후 $b$가 일어나고  
- $c, b$ 가 모두 일어나고 $a$가 일어난 상황  

차례대로 곱한것이다.  

그림으로 예를 들어보면 아래와 같다.  

![1](/assets/math/statistics/probability7.png)

주변확률인 3개일 때 **조건부분포**를 분해할 수 도 있다.  

$P(X=a,Y=b|Z=c)=P(X=a|Y=b,Z=c)P(Y=b|Z=c)$

### 독립성

> 독립성: Independent Component
> 확률변수 $X=a, Y=b$ 가 독립적일때 확률변수 $X, Y$ 는 독립되어 있다.  
> 반대로 독립이 아닐경우 **종속** 이라 한다.  

B 발생후 업데이트된 A가 발생할 확률이 A가 그냥 일어나는 확률이나 같다는 것.
즉 **B 발생여부가 A의 확률에 전혀 영향을 끼치지 않는다** 는 것이다.    

두 사건 발생이 서로 **독립**일 때 아래 공식들이 만족한다.  

- $P(A|B) = P(A)$
- $P(A|B) = P(A|B^c)$
- $P(A,B) = P(A)P(B)$
- $P(A,B):P(A,B^c) = P(A^c,B):P(A^c,B^c)$

**예제) 트럼프**  
트럼프카드 52장을 예로 들어보자.  

- $P(\mathrm{spade})=\frac{1}{4}$ 스페이드를 뽑는것  
- $P(\mathrm{picture})=\frac{9}{52}$ 그림을 뽑는것  

두 조건이 독립인지 확인해보면 아래와 같다.  

$P(\mathrm{picture}|\mathrm{spade}) = \frac{3}{13}$  
$P(\mathrm{picture}|\mathrm{spade}^c) = \frac{9}{39} = \frac{3}{13} $  

스페이드에서 그림을 뽑든, 스페이드가 아닌것에서 그림을 뽑든 두 확률은 서로 같기에 독립이다.  
그림으로 비교하면 아래와 같다

![1](/assets/math/statistics/probability9.png)

`스페이드 그림카드`와 `스페이드 이외의 그림카드` 의 비율이 정확히 일치한다.  
즉 **스페이드에서 그림을 뽑든, 전체에서 그림을 뽑든 동일하기에 둘은 독립변수**이다.  

이번에 `스페이드 1,2,3` 카드와 `하트의 J,Q,K`, 총 6장을 제거하여 **독립성을 깨보자**.  
공식으로 나타내면 아래와 같다.  

$ \begin{cases}
    P(스페이드|그림) = \frac{3}{46} \\ 
    P(스페이드,그림)=\frac{10}{46}*\frac{9}{46} = \frac{1.956}{46}
\end{cases} $

그림을 그리면 아래와 같다.  

![1](/assets/math/statistics/probability9-1.png)  

**표 예제**  
표 혹은 수식이 주어지면 독립인지 확인할때 가장 많이 사용하는 공식은 아래 2개

1. $P(A,B) = P(A)P(B)$
1. $P(A,B):P(A,B^c) = P(A^c,B):P(A^c,B^c)$

아래와 같은 식이 있다 해보자.  

$P(X=a, Y=b) = \frac{1}{280}a^2(b+1)$

1번 공식을 사용하면  

- $X$관련된 식은 $\frac{1}{280}a^2$, 
- $Y$관련된 식은$(b+1)$ 

두 확률변수가 1번 공식과 유사하다는것을 알수 있고 $X, Y$ 가 독립임을 바로 알 수 있다.  


![1](/assets/math/statistics/probability10.png)  

2번 공식을 사용하면 표를보고 $X, Y$ 의 결합분포 비율이 모두 같은걸 보고 서로 독립임을 바로 알 수 있다.  

> **3개 이상의 독립성**
확률변수가 2개가 아니라 3개일 경우 
$P(X=a,Y=b,Z=c)=P(X=a)P(Y=b)P(Z=c)$ 를 만족한다.  
4개일 경우에도 마찬가지

## 확률밀도함수, 누적분포함수  

> 확률밀도함수: PDF(Probability Density Function)
> 누적분포함수: CDF(Cumulative Distribution Function)

확률변수 `X` 가 `a ~ b` 까지 존재할 수 있을 때 아래처럼 생길 수 있다.  

![1](/assets/math/statistics/probability22.png)  

연속활률분포에선 그래프이기 때문에 시그마가 아닌 인테그랄(적분식)으로 표기한다.  
이산확률분포와 똑같이 각 변량 $x$에 대한 도수 $f(x)$ 의 합을 적분식으로 표기하며
f(x)의 모든 합은 1이된다.

$$ \int_a^b f(x) dx = 1 $$

**평균(E)** 는 밀도함수의 결과값 $f(x)$ 와 연속확률 변수 $x$ 를 곱한값을 적분한 것이다. 

$$ E(X) = \int_a^b xf(x) dx $$  

**분산(V)** 는 편차제곱과 밀도함수의 결과값을 곱한값을 적분한것.  

$$ V(X) = \int_a^b (x-m)^2 f(x) dx = \int_a^b x^2 f(x) dx - m^2 $$



### 확률밀도함수의 변수변환

확률변수 $X$ 의 확률분포를 알고 있고  
$Y=g(X)$ 변환처리를 한 확률변수 $Y$ 를 구한다면  
그에 해당하는 확률분포를 어떻게 표기하는가  

예를들어 확률변수 X의 확률밀도함수 $f_X$  
확률변수 $Y=3X-5$ 확률밀도함수 $f_Y$ 를 예로들면  

아래와 같은 그래프를 그릴 수 있다.  

![1](/assets/math/statistics/probability23.png)  

$x$ 는 `-4 ~ 4` 까지 총 8 칸을 사용할때  
$y$ 는 `-17 ~ 7` 까지 총 24 칸을 사용하였다.  

총 확률 1을 **8개로 나눠먹느냐24개로 나눠먹느냐** 라고 할 수 있다.  

이는 밀도가 전반적으로 3배 차이가 난다는 뜻이다.  

실제 해당 확률밀도 함수가 가질 밀도는 3배 차이가 난다는 것을 식으로 표현하면 아래와 같다.  

$f_Y(4) = \frac{1}{3} f_X(3)$  

정형화된 공식으로는 아래와 같다.  

$f_Y(y) = |\frac{f_X(x)}{g`(x)}|$  

위 공식에 $f_Y$ 와 $f_X$ 를 대입하면 아래와 같이 풀어쓸 수 있다.  

$$ \because X = \frac{Y+5}{3} \\ \ \\
f_Y(y) = |\frac{f_X(x)}{g'(x)}| \\ \ \\
f_Y(y) = |\frac{f_X(\frac{Y+5}{3})}{3}| \\ \ \\
f_Y(y) = \frac{1}{3} f_X(\frac{Y+5}{3}) $$

$Y$ 에 에 값을 대입해 위 그래프와 같이 출력되는지 확인  

## 연속활률분포 특징

### 결합분포, 주변분포

이산확률에서 **결합확률**을 아래와 같이 정의지었다.  

> 여러 조건을 지정하고 모든 조건이 동시에 성립하는 확률을 **결합확률**이라 하며 동시확률이라 부르기도 한다.

**연속확률분포에서 결합확률에대한 분포**는 아래와 같이 말할 수 있다.  

> $X,Y$ 를 세트로 하는 2차원 벡터 $W=(X,Y)$ 에 대한 결합분포  

그리고 $\vec{W}$ 를 **확률밀도함수**로 그래프로 그리면 아래와 같고 
결합된 확률변수의 범위안의 확률은 **부피**와 같다.  

![1](/assets/math/statistics/probability24.png)  

기존 확률밀도함수처럼 전 영역에서 적분하면 1이 된다.  

$$ \int_{-\infin}^\infin (\int_{-\infin}^\infin f_{X,Y}(x,y)dx)dy = 1 $$  
$$ \int_{-\infin}^\infin (\int_{-\infin}^\infin f_{X,Y}(x,y)dy)dx = 1 $$  

이산확률에서 **주변확률**를 아래와 같이 정의지었다.  

> **결합확률의 각 조건을 주변확률** 이라 한다.
$P(X, Y) 결합확률에서 $P(X=a), P(Y=b)$ 가 **주변확률**이 된다.  

아래 그림과 같이 **단면적의 부피를 주변확률** 이라 할 수 있다  

> 2개의 확률변수를 가진 연속확률분포에선 면적이 아닌 부피가 확률이기에 그림처럼 주변확률 하나를 고정해두면 0에 가까운 부피값이 나온다. 
> 하지만 설명의 위해 부피가 아닌 면적을 기반으로 설명하는것을 주의

![1](/assets/math/statistics/probability25.png)  

왼쪽이 $f_X(0)$, 오른쪽이 $f_Y(0.3)$ 일때의 주변확률이다 .   


그리고 이 주변확률을 모두 모아 주변분포를 만들고, 그 분포의 확률밀도함수인 **주변확률밀도함수** 를 구하는 방식은 아래 그림과 같다.  

![1](/assets/math/statistics/probability26.png)  

$\vec{W}$ 를 2차원에서 잉크의 농담처럼 표기하고 $y$ 축 방향을 눌러 $x$ 축 위에 모으면 $f_X(x)$ 의 **주변확률밀도함수**이다.  

식으로 표현하면 다음과 같다.  

$$ f_X(x)=\int_{-\infin}^\infin f_{X,Y}(x,y)dy=1 \\ \ \\
f_Y(y)=\int_{-\infin}^\infin f_{X,Y}(x,y)dx=1 $$

### 조건부분포  

이산확률에서 **조건부확률은 비중에 따른 확률값** 이다.  

> `∣` 기호는 조건부확률에서 사용되며 영어로 given 으로 읽는다, 현재 예에는 비중이라 할 수 있다.
> 조건부확률을 결합확률로 표기하면 아래와 같다.  
> 
> $P(Y=b | X=a) = \frac{P(Y=b, X=a)}{P(X=a)}$


연속확률에선 다시 아래의 단면적 그래프로 생각해야 한다.  

> 이것도 마찬가지로 설명을 위해 부피가 아닌 면적을 기반으로 이야기한다.  
> 하지만 사실 부피를 이야기하는 것임을 주의

![1](/assets/math/statistics/probability27.png)  

$X=0$ 이라는 조건에서 어떤 $Y$ 값이 나올지 아는것은 대략 알 수 있다.  

잘린 단면의 형태를 $g(y) = f_{X,Y}(a,y)$ 라 할때 나오는 가장 높은값이 높은 확률로 나올 Y 값이다.  

그럼 **조건부확룰밀도함수** 는 어떻게 구하는가하면 해당 단면적이 1이 되도록 만들면 된다.  
현재 $g(y)$ 의 적분은 1이라 할 수 없지만 여기에 특정 상수 $c$ 를 추가해 적분값이 1이 되도록 조절한다.  

아래 그림과 같이 기존 절개된 부분(굵은선)을 
![1](/assets/math/statistics/probability28.png)  

> 나중에 설명하지만 이 $c$ 값이 **비중**이 된다. 

$$ h(y) = \frac{g(y)}{c} $$

이 $h(y)$ 값이 **조건부확룰밀도함수** $f_{Y|X}(b|a)$ 이다.  

$h(y)$ 의 단멱적이 1 이기에 적분식은 아래와 같고  

$$ \int_{-\infin}^\infin h(y)dy = \frac{1}{c}\int_{-\infin}^\infin g(y)dy = 1 $$

이는 $\int_{-\infin}^\infin g(y)dy$ 값이 $c$ 와 동일해지는것을 의미,  

그리고 $\int_{-\infin}^\infin g(y)dy$ 를 주변분포로 표기하여 유도하면 $f_X(a)$ 와 동일해진다.  

$$ c = \int_{-\infin}^\infin g(y)dy = \int_{-\infin}^\infin f_{X,Y}(a,y)dy = f_X(a) $$

그래서 최종적으로 **조건부확룰밀도함수** $f_{Y|X}(b|a)$ 를 표기하는 식은 아래와 같다.  

$$ h(y) = \frac{g(y)}{c} = \frac{f_{X,Y}(a,y)}{f_X(a)} \\ \ \\
f_{Y|X}(b|a) = \frac{f_{X,Y}(a,y)}{f_X(a)} $$

이산확률과 마찬가지로 결합확률밀도함수를 을 조건부확률밀도함수로 표현할 수 있다.  

$$f_{X,Y}(a,b) = f_{Y|X}(b|a)f_X(a)$$

### 베이즈공식  


> 베이즈이론: 조건부확률을 응용해서 결과에서 원인을 찾는 경우
> $P(X=▲), P(Y=○|X=▲)$ 를 알고 있을때 
> $P(X=▲|Y=○)$ 조건부확률을 구하는 것을 베이즈 공식이라 한다.  

이산확률에서 베이즈공식은 **조건부확률과 결합확률의 관계**를 통해 아래와 같은 식을 통해 구할 수 있었다.  

$$ P(A|B) = \frac{P(A , B)}{P(B)} = \frac{P(B|A)P(A)}{\sum_x P(B,x)} = \frac{P(B|A)P(A)}{\sum_x P(B|x)P(x)} $$

연속활률에선 $\sum$ 을 $\int$ 로만 변경해주면 된다.  

$$ f_{X,Y}(A|B) = \frac{f_{Y,X}(B|A)f_X(A)}{\int_{-\infin}^\infin f_{Y,X}(B|x)f_X(x)dx} $$

### 독립성  

이산확률에서 두 사건 발생이 서로 **독립**일 때 아래 공식들이 만족한다.  

- $P(A|B) = P(A)$
- $P(A|B) = P(A|B^c)$
- $P(A,B) = P(A)P(B)$
- $P(A,B):P(A,B^c) = P(A^c,B):P(A^c,B^c)$

연속확률도 그대로 사용하면 된다.  

그래프로 표기하며 아래와 같다.  

![1](/assets/math/statistics/probability29.png)  

잘린 단면의 모양이 높이값을 제외한다면, 완벽히 일치할 경우 독립이라 볼 수 있다.  

> $f_{X,Y}(a,y) = c f_{X,Y}(\hat{a}, y)$
> $f_{X,Y}(x,b) = c f_{X,Y}(x, \hat{b})$
> 위 식과 같이 어떤 $X$ 혹은 $Y$ 가 고정되어 있는 상태에서 상수 $c$ 를 곱하면 일치할 경우 식이 일치할 경우

조건부분포의 경우 단멱적이 1이 되도록 변환해야하기에 값의 차이가 상수 $c$ 차이라면 최종 출력되는 확률값은 모두 동일하다 할 수 있다.   

### 변수변환  

확률변수 $X,Y$ 그리고 변환된 확률변수 $Z=2X, W=Y$ 로 변환, 혹은 $Z=X, W=1.5Y$ 로 변환했을 때 

$f_{X,Y}(x,y)$ 와 $f_{Z,W}(z,w)$ 의 관계는?

![1](/assets/math/statistics/probability30.png)  

아파 확률별수 사이즈를 일방적으로 늘리면 위 그림과 같이 잉크의 농도가 옅어질 것이다.  

범위가 늘어난다 한들 부피는 1을 유치해야하지 때문에 늘어난 범위만큼 높이가 줄어들 것  

따라서 $Z=2X, W=Y$ 로 변환되었다면 

$f_{Z,W}(z,w) = \frac{1}{2}f_{X,Y}(\frac{1}{2}z,w)$ 관계를 가지게 된다.  

## 기대값, 분산, 표준편차  

**연속확률에서 기대값** 역시 이산확륣의 $\sum$ 을 $\int$ 로 변경하기만 하면 된다.  

$$ E[X] = \int_{-\infin}^\infin x f(x) dx $$

수식으로만 생각하면 연속된 확률변수 $x$ 와 해당 확률변수에서 발생가능한 확률 $f(x)$ 를 모두 $\int$ 하면 기대값이 나온다.  

$ V[X] = E[(X - m)^2]$

$\sigma = \sqrt{V[X]}$

연속활률이라 해도 이산확률의 기대값, 분산, 표준편차와 차이 $\sum, \int$ 만 있을뿐 수식에는 없다.  
